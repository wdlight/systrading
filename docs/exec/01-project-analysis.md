# 프로젝트 분석 및 계획 수립

**날짜**: 2025-09-11  
**작성자**: Claude  
**단계**: Phase 0 - 분석 및 계획

## 개요

PyQt5 기반 `rsimacd_trading.py`의 워치리스트 기능을 웹 백엔드로 마이그레이션하여 프론트엔드에서 실제 데이터로 동작하도록 하는 프로젝트입니다.

## 요구사항 분석

### 핵심 기능
1. **실시간 워치리스트 관리**: 종목 추가/제거, 실시간 가격 업데이트
2. **기술적 지표 계산**: MACD(9,18,6), RSI(14) - PyQt5와 동일한 파라미터
3. **매매 로직 통합**: 자동매매 조건 체크 및 실행
4. **실시간 데이터 처리**: WebSocket을 통한 실시간 업데이트

### 기존 PyQt5 구조 분석

#### 핵심 데이터 구조
```python
# realtime_watchlist_df 구조
columns = [
    '현재가',           # 실시간 가격
    '수익률',           # 계산된 수익률 (%)
    '평균단가',         # API에서 받은 매입단가
    '보유수량',         # 보유 주식 수량
    'MACD',            # MACD 지표
    'MACD시그널',      # MACD 시그널
    'RSI',             # RSI 지표
    '트레일링스탑발동여부',
    '트레일링스탑발동후고가'
]
```

#### 핵심 프로세스
1. **매수 조건 확인**: RSI + MACD 시그널
2. **매수 주문 실행**: 시장가 주문
3. **watchlist 추가**: 실시간 모니터링 시작
4. **계좌조회**: 실제 체결 정보 업데이트
5. **수익률 계산**: 평균단가 기반 실시간 계산

## 구현 계획

### Phase 1: 클래스 구조 리팩토링 - 서비스 클래스 분리
- [x] Pydantic 데이터 모델 정의
- [x] TechnicalAnalysisService 구현
- [x] WatchlistService 구현
- [x] TradingService 구현
- [x] 의존성 주입 컨테이너 구현

### Phase 2: 워치리스트 관리 API 구현
- [x] 워치리스트 CRUD API 엔드포인트
- [x] 실시간 데이터 업데이트 API
- [x] 매매 조건 설정 API
- [x] WebSocket 실시간 데이터 연동

### Phase 3: 단위 테스트 작성
- [ ] 서비스 클래스 단위 테스트
- [ ] API 엔드포인트 테스트

### Phase 4: 프론트엔드 연동
- [ ] 기존 더미 데이터를 실제 API 호출로 변경
- [ ] WebSocket 연결 및 실시간 업데이트
- [ ] 사용자 인터페이스 개선

### Phase 5: 검증 및 최적화
- [ ] 성능 테스트 및 최적화
- [ ] 오류 처리 개선
- [ ] 문서화 완료

## 기술 스택

### Backend
- **FastAPI**: 웹 API 프레임워크
- **Pydantic**: 데이터 검증 및 직렬화
- **pandas**: 데이터 분석 및 처리
- **TA-Lib**: 기술적 지표 계산
- **WebSocket**: 실시간 데이터 스트리밍

### Frontend
- **React**: 사용자 인터페이스
- **TypeScript**: 타입 안전성
- **WebSocket Client**: 실시간 데이터 수신

## 핵심 아키텍처 패턴

1. **서비스 지향 아키텍처**: 도메인별 서비스 분리
2. **의존성 주입**: 느슨한 결합을 통한 테스트 가능성
3. **리포지토리 패턴**: 데이터 접근 계층 추상화
4. **이벤트 기반**: WebSocket을 통한 실시간 업데이트

## 예상 도전 과제

1. **실시간 성능**: 2초 주기 업데이트의 효율적 처리
2. **데이터 동기화**: 여러 클라이언트 간 데이터 일관성
3. **오류 복구**: 네트워크 단절 시 자동 재연결
4. **메모리 관리**: 장시간 실행 시 메모리 누수 방지

## 성공 지표

1. **기능적 완성도**: PyQt5와 동일한 모든 기능 구현
2. **성능**: 2초 내 실시간 업데이트 처리
3. **안정성**: 24시간 연속 운영 가능
4. **사용성**: 직관적인 웹 인터페이스 제공