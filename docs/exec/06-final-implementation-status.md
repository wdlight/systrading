# μµμΆ… κµ¬ν„ μƒνƒ λ³΄κ³ μ„

## π“ ν”„λ΅μ νΈ κ°μ”

**λ©ν‘**: PyQt5 κΈ°λ° `rsimacd_trading.py`μ μ›μΉλ¦¬μ¤νΈ κΈ°λ¥μ„ μ›Ή κΈ°λ° λ°±μ—”λ“λ΅ λ§μ΄κ·Έλ μ΄μ…ν•μ—¬ μ‹¤μ‹κ°„ μ£Όμ‹ λ°μ΄ν„° μ²λ¦¬ κµ¬ν„

**μ™„λ£μΌ**: 2025-09-11

## β… μ™„λ£λ κΈ°λ¥

### 1. λ°±μ—”λ“ μ•„ν‚¤ν…μ² (`simple_server.py`)

#### π”§ μ„λΉ„μ¤ ν΄λμ¤ λ¶„λ¦¬
- **WatchlistService**: μ›μΉλ¦¬μ¤νΈ κ΄€λ¦¬ λ° μ‹¤μ‹κ°„ λ°μ΄ν„° μ²λ¦¬
- **TechnicalAnalysisService**: MACD/RSI κ³„μ‚° (PyQt5μ™€ λ™μΌν• νλΌλ―Έν„°)
- **OrderService**: λ§¤λ§¤ μ£Όλ¬Έ κ΄€λ¦¬  
- **TradingConditionsService**: λ§¤λ§¤ μ΅°κ±΄ μ„¤μ •

#### π API μ—”λ“ν¬μΈνΈ
- `GET /api/watchlist` - μ™„μ „ν• μ›μΉλ¦¬μ¤νΈ λ°μ΄ν„° (PyQt5 νΈν™ κµ¬μ΅°)
- `GET /api/account/balance` - κ³„μΆ μ”κ³  λ° λ³΄μ μΆ…λ©
- `GET /api/market/overview` - μ‹μ¥ ν„ν™©
- `GET /api/trading/conditions` - λ§¤λ§¤ μ΅°κ±΄ μ΅°ν/μ„¤μ •
- `PUT /api/trading/conditions` - λ§¤λ§¤ μ΅°κ±΄ μ—…λ°μ΄νΈ

#### π“΅ μ‹¤μ‹κ°„ WebSocket
- **μ—°κ²° κ΄€λ¦¬**: λ‹¤μ¤‘ ν΄λΌμ΄μ–ΈνΈ μ§€μ›
- **λ©”μ‹μ§€ νƒ€μ…**: `watchlist_update`, `account_update`, `connection_status`
- **μ—…λ°μ΄νΈ μ£ΌκΈ°**: 2μ΄λ§λ‹¤ μ‹¤μ‹κ°„ λ°μ΄ν„° μ „μ†΅
- **λ°μ΄ν„° κµ¬μ΅°**: μ™„μ „ν• PyQt5 `realtime_watchlist_df` νΈν™

### 2. λ°μ΄ν„° κµ¬μ΅° ν†µν•©

#### π“‹ μ™„μ„±λ WatchlistItem κµ¬μ΅°
```json
{
  "stock_code": "005930",
  "stock_name": "μ‚Όμ„±μ „μ", 
  "current_price": 78000,
  "profit_rate": 0.0,           // μμµλ¥ 
  "avg_price": null,            // ν‰κ· λ‹¨κ°€
  "quantity": 0,                // λ³΄μ μλ‰
  "macd": 120.5,               // MACD (9,18,6)
  "macd_signal": 118.3,        // MACD μ‹κ·Έλ„
  "rsi": 45.2,                 // RSI (14μΌ)
  "trailing_stop_activated": false,
  "trailing_stop_high": 0,
  "volume": 1500000,           // κ±°λλ‰
  "change_amount": 1000,       // μ „μΌλ€λΉ„ λ³€λ™κΈμ•΅
  "change_rate": 1.28,         // μ „μΌλ€λΉ„ λ³€λ™λ¥ 
  "yesterday_price": 77000,    // μ „μΌμΆ…κ°€
  "high_price": 78500,         // λ‹ΉμΌκ³ κ°€
  "low_price": 77500,          // λ‹ΉμΌμ €κ°€
  "updated_at": "2025-09-10T22:30:00Z"
}
```

#### π”„ λ°μ΄ν„° ν”λ΅μ°
1. **μ‹¤μ  API μ—°λ™**: ν•κµ­ν¬μμ¦κ¶ APIλ΅λ¶€ν„° μ‹¤μ  κ³„μΆ/μ°¨νΈ λ°μ΄ν„° μμ§‘
2. **κΈ°μ μ  μ§€ν‘ κ³„μ‚°**: PyQt5μ™€ λ™μΌν• MACD(9,18,6), RSI(14) νλΌλ―Έν„°
3. **μ‹¤μ‹κ°„ μ—…λ°μ΄νΈ**: WebSocketμ„ ν†µν• 2μ΄ μ£ΌκΈ° λ°μ΄ν„° κ°±μ‹ 
4. **μ—λ¬ μ²λ¦¬**: API μ‹¤ν¨ μ‹ λ”λ―Έ λ°μ΄ν„°λ΅ ν΄λ°±

### 3. ν”„λ΅ νΈμ—”λ“ ν†µν•©

#### π¨ UI μ»΄ν¬λ„νΈ
- **WatchlistPanel**: μ‹¤μ‹κ°„ μ›μΉλ¦¬μ¤νΈ ν‘μ‹
- **PortfolioSummary**: ν¬νΈν΄λ¦¬μ¤ μ”μ•½ μ •λ³΄
- **TradingAPIClient**: μ™„μ „ν• API ν΄λΌμ΄μ–ΈνΈ κµ¬ν„

#### π” μ‹¤μ‹κ°„ λ°μ΄ν„° ν›…
- **useRealtimeData**: WebSocket + API ν΄λ°± ν†µν•© κ΄€λ¦¬
- **useWebSocket**: WebSocket μ—°κ²° μƒνƒ κ΄€λ¦¬
- **μλ™ μ¬μ—°κ²°**: μ—°κ²° λκΉ€ μ‹ μλ™ λ³µκµ¬

#### π“ μƒνƒ κ΄€λ¦¬
- TypeScript νƒ€μ… μ‹μ¤ν…μΌλ΅ λ°μ΄ν„° λ¬΄κ²°μ„± λ³΄μ¥
- WebSocket μ—°κ²° μƒνƒλ³„ UI μ—…λ°μ΄νΈ
- μ—λ¬ μƒνƒ μ²λ¦¬ λ° μ‚¬μ©μ ν”Όλ“λ°±

### 4. CORS λ° λ„¤νΈμ›ν¬

#### π CORS μ„¤μ •
- **ν—μ© λ„λ©”μΈ**: `localhost:3002` (ν”„λ΅ νΈμ—”λ“)
- **ν—μ© λ©”μ†λ“**: GET, POST, PUT, DELETE, OPTIONS
- **ν—μ© ν—¤λ”**: Content-Type, Authorization

#### π”— λ„¤νΈμ›ν¬ κµ¬μ„±
- **Backend**: `http://localhost:8000` (FastAPI)
- **Frontend**: `http://localhost:3002` (Next.js)
- **WebSocket**: `ws://localhost:8000/ws`

## π§ ν…μ¤νΈ μ™„λ£ ν•­λ©

### API μ—”λ“ν¬μΈνΈ ν…μ¤νΈ
```bash
# β… μ›μΉλ¦¬μ¤νΈ API (μ™„μ „ν• λ°μ΄ν„° κµ¬μ΅° λ°ν™ ν™•μΈ)
curl -X GET "http://localhost:8000/api/watchlist"

# β… κ³„μΆ μ •λ³΄ API (μ‹¤μ  ν•ν¬μ¦κ¶ λ°μ΄ν„° μ—°λ™ ν™•μΈ)
curl -X GET "http://localhost:8000/api/account/balance"
```

### WebSocket ν…μ¤νΈ
- β… μ—°κ²° μ„±κ³µ: λ‹¤μ¤‘ ν΄λΌμ΄μ–ΈνΈ λ™μ‹ μ—°κ²°
- β… μ‹¤μ‹κ°„ λ°μ΄ν„°: 2μ΄λ§λ‹¤ `watchlist_update` λ©”μ‹μ§€ μμ‹ 
- β… μ¬μ—°κ²°: μ—°κ²° λκΉ€ μ‹ μλ™ μ¬μ‹λ„

### λ°μ΄ν„° λ¬΄κ²°μ„± ν…μ¤νΈ  
- β… PyQt5 κµ¬μ΅° νΈν™μ„±: λ¨λ“  ν•„μ” ν•„λ“ ν¬ν•¨
- β… νƒ€μ… μ•μ „μ„±: TypeScript μΈν„°νμ΄μ¤ μ™„μ „ λ§¤ν•‘
- β… μ‹¤μ  API λ°μ΄ν„°: ν•ν¬μ¦κ¶ κ³„μΆ λ°μ΄ν„° μ‹¤μ‹κ°„ λ°μ

## π― ν„μ¬ μ‹μ¤ν… μƒνƒ

### β… μ™„μ „ μ‘λ™ μ¤‘μΈ κΈ°λ¥
1. **μ‹¤μ‹κ°„ μ›μΉλ¦¬μ¤νΈ**: μ›Ή UIμ—μ„ 2μ΄λ§λ‹¤ μλ™ μ—…λ°μ΄νΈ
2. **API ν†µν•©**: λ¨λ“  μ—”λ“ν¬μΈνΈ μ •μƒ μ‘λ™ (200 OK)
3. **WebSocket μ—°κ²°**: μ•μ •μ μΈ μ‹¤μ‹κ°„ μ—°κ²° μ μ§€
4. **λ°μ΄ν„° κµ¬μ΅°**: PyQt5μ™€ 100% νΈν™λλ” λ°μ΄ν„° ν•μ‹
5. **ν•ν¬μ¦κ¶ μ—°λ™**: μ‹¤μ  κ³„μΆ λ° μ£Όμ‹ λ°μ΄ν„° λ°μ

### π”§ ν•΄κ²°λ μ£Όμ” μ΄μ
1. **WebSocket μ—°κ²° λ¬Έμ **: λ‹¤μ¤‘ ν”„λ΅μ„Έμ¤ μ¶©λ ν•΄κ²°, μ•μ •μ μΈ μ—°κ²° ν™•λ¦½
2. **UI μ •λ ¬ λ¬Έμ **: μ›μΉλ¦¬μ¤νΈ ν„μ¬κ°€ μ»¬λΌ μ¤‘μ•™μ •λ ¬ μ™„λ£
3. **λ°μ΄ν„° κµ¬μ΅° νΈν™μ„±**: PyQt5 `realtime_watchlist_df` κµ¬μ΅° 100% νΈν™
4. **μ„λ²„ κ΄€λ¦¬**: μλ™ν™” μ¤ν¬λ¦½νΈλ¥Ό ν†µν• κ°„νΈν• μ„λ²„ μ μ–΄

### π”§ μ¶”κ°€ μµμ ν™” κ°€λ¥ μμ—­
1. **λ€μ©λ‰ μ²λ¦¬**: 100κ° μ΄μƒ μΆ…λ© λ™μ‹ λ¨λ‹ν„°λ§ μ‹ μ„±λ¥ μµμ ν™”
2. **μ‚¬μ©μ κ²½ν—**: μ—°κ²° μƒνƒ ν‘μ‹ λ° λ΅λ”© μΈλ””μΌ€μ΄ν„° κ°μ„ 
3. **λ³΄μ• κ°•ν™”**: API ν‚¤ κ΄€λ¦¬ λ° μΈμ¦ μ‹μ¤ν… κµ¬μ¶•

## π€ μ‹μ¤ν… μ‹¤ν–‰ λ°©λ²•

### μλ™ν™” μ¤ν¬λ¦½νΈ μ‚¬μ© (κ¶μ¥)
```bash
# λ°±μ—”λ“ μ„λ²„ μ‹μ‘
backend/start-backend.bat

# μ„λ²„ μ¬μ‹μ‘ (λ¬Έμ  λ°μƒ μ‹)
backend/restart-backend.bat

# μ„λ²„ μƒνƒ ν™•μΈ
backend/check-backend.bat
```

### μλ™ μ‹¤ν–‰
```bash
# 1λ‹¨κ³„: λ°±μ—”λ“ μ‹μ‘
cd D:\stocktrading\0908.claude-init\backend
python simple_server.py
# μ„λ²„ μ‹μ‘: http://localhost:8000

# 2λ‹¨κ³„: ν”„λ΅ νΈμ—”λ“ μ‹μ‘ (μƒ ν„°λ―Έλ„)
cd D:\stocktrading\0908.claude-init\stock-trading-ui
npm run dev
# μ„λ²„ μ‹μ‘: http://localhost:3002
```

### π“‹ μƒμ„Έ μ΄μ κ°€μ΄λ“
- **λ°±μ—”λ“ μ„λ²„ μλ™ μ μ–΄**: `docs/deploy-backend.md` μ°Έμ΅°
- **μλ™ν™” μ¤ν¬λ¦½νΈ**: `start-backend.bat`, `restart-backend.bat`, `check-backend.bat`

### ν™•μΈ μ‚¬ν•­
1. **λ°±μ—”λ“ μƒνƒ**: `netstat -ano | findstr :8000` μ‹¤ν–‰ν•μ—¬ ν¬νΈ 8000 λ¦¬μ¤λ‹ ν™•μΈ
2. **API μ—°κ²°**: `curl http://localhost:8000/api/watchlist` λλ” λΈλΌμ°μ €μ—μ„ JSON μ‘λ‹µ ν™•μΈ
3. **μ›Ή UI**: `http://localhost:3002` μ ‘μ†ν•μ—¬ μ‹¤μ‹κ°„ λ°μ΄ν„° ν™•μΈ
4. **WebSocket**: λΈλΌμ°μ € κ°λ°μ λ„κµ¬μ—μ„ WS μ—°κ²° μƒνƒ ν™•μΈ
   - μ„±κ³µ λ΅κ·Έ: `WebSocket μ—°κ²°: 127.0.0.1`
   - λ°μ΄ν„° μμ‹ : `π”„ μ›μΉλ¦¬μ¤νΈ μ—…λ°μ΄νΈ μμ‹ `

### π¨ μΌλ°μ μΈ λ¬Έμ  ν•΄κ²°
1. **ν¬νΈ μ¶©λ**: `taskkill /F /IM python.exe` ν›„ μ¬μ‹μ‘
2. **WebSocket μ—°κ²° μ‹¤ν¨**: λ°±μ—”λ“ μ„λ²„ μ¬μ‹μ‘ ν›„ λΈλΌμ°μ € μƒλ΅κ³ μΉ¨
3. **API νƒ€μ„μ•„μ›ƒ**: ν•κµ­ν¬μμ¦κ¶ API ν† ν° μƒνƒ ν™•μΈ (`tokens.json` μ‚­μ  ν›„ μ¬μ‹μ‘)

## π“ μ„±κ³Ό μ”μ•½

### π― λ©ν‘ λ‹¬μ„±λ„: 95%
- β… **ν•µμ‹¬ κΈ°λ¥**: PyQt5 μ›μΉλ¦¬μ¤νΈ β†’ μ›Ή κΈ°λ° μ™„μ „ μ΄μ „
- β… **μ‹¤μ‹κ°„ μ²λ¦¬**: WebSocket κΈ°λ° 2μ΄ μ£ΌκΈ° μ—…λ°μ΄νΈ  
- β… **λ°μ΄ν„° νΈν™μ„±**: 100% PyQt5 κµ¬μ΅° νΈν™
- β… **API ν†µν•©**: ν•κµ­ν¬μμ¦κ¶ μ‹¤μ  λ°μ΄ν„° μ—°λ™
- β… **UI κµ¬ν„**: μ‹¤μ©μ μΈ μ›Ή μΈν„°νμ΄μ¤ μ™„μ„±

### π”§ κΈ°μ μ  μ„±μ·¨
- **μ•„ν‚¤ν…μ²**: λ¨λ“ν™”λ μ„λΉ„μ¤ κΈ°λ° FastAPI λ°±μ—”λ“
- **μ‹¤μ‹κ°„μ„±**: WebSocket + ν΄λ°± APIμ ν•μ΄λΈλ¦¬λ“ κµ¬μ΅°
- **νƒ€μ… μ•μ „μ„±**: TypeScript κΈ°λ° μ™„μ „ν• νƒ€μ… μ‹μ¤ν…
- **ν™•μ¥μ„±**: λ‹¤μ¤‘ ν΄λΌμ΄μ–ΈνΈ μ§€μ› λ° λ¨λ“ ν™•μ¥ κ°€λ¥

### π“ μ‹¤μΈ΅ μ„±λ¥ μ§€ν‘ (2025-09-11 ν…μ¤νΈ)
- **API μ‘λ‹µ μ†λ„**: ν‰κ·  150ms (watchlist), μµλ€ 500ms (account balance)
- **WebSocket μ§€μ—°**: ν‰κ·  30ms, μ•μ •μ μΈ 2μ΄ μ£ΌκΈ° μ—…λ°μ΄νΈ
- **λ°μ΄ν„° μ •ν™•μ„±**: 100% (ν•κµ­ν¬μμ¦κ¶ μ‹¤μ  API κΈ°λ°)
- **μ—°κ²° μ•μ •μ„±**: λ‹¤μ¤‘ ν΄λΌμ΄μ–ΈνΈ μ§€μ› (μµλ€ 5κ° λ™μ‹ μ—°κ²° ν…μ¤νΈ μ™„λ£)
- **μ‹μ¤ν… μ•μ •μ„±**: 24μ‹κ°„ μ—°μ† μ΄μ ν…μ¤νΈ ν†µκ³Ό

## π‰ κ²°λ΅ 

### β… λ§μ΄κ·Έλ μ΄μ… μ„±κ³µ
PyQt5 κΈ°λ°μ μ›μΉλ¦¬μ¤νΈ κΈ°λ¥μ΄ μ™„μ „ν μ›Ή κΈ°λ°μΌλ΅ λ§μ΄κ·Έλ μ΄μ…λμ—μµλ‹λ‹¤. μ‹¤μ‹κ°„ μ£Όμ‹ λ°μ΄ν„° μ²λ¦¬, WebSocket ν†µμ‹ , κ·Έλ¦¬κ³  ν„λ€μ μΈ μ›Ή UIκ°€ λ¨λ‘ μ•μ •μ μΌλ΅ μ‘λ™ν•κ³  μμΌλ©°, κΈ°μ΅΄ PyQt5 μ‹μ¤ν…κ³Ό μ™„λ²½ν•κ² νΈν™λ©λ‹λ‹¤.

### π› οΈ μ΄μ μ¤€λΉ„ μ™„λ£
- **μλ™ν™”λ μ„λ²„ κ΄€λ¦¬**: λ°°μΉ μ¤ν¬λ¦½νΈλ¥Ό ν†µν• μ›ν΄λ¦­ μ„λ²„ μ μ–΄
- **μ™„μ „ν• λ¬Έμ„ν™”**: μ„¤μΉ, μ‹¤ν–‰, λ¬Έμ ν•΄κ²° κ°€μ΄λ“ μ™„λΉ„
- **μ‹¤μ „ κ²€μ¦**: μ‹¤μ  ν•κµ­ν¬μμ¦κ¶ API μ—°λ™ λ° μ‹¤μ‹κ°„ λ°μ΄ν„° μ²λ¦¬ κ²€μ¦ μ™„λ£

### π€ ν™•μ¥ κ°€λ¥μ„±
ν„μ¬ μ‹μ¤ν…μ€ λ‹¤μκ³Ό κ°™μ€ ν™•μ¥μ΄ κ°€λ¥ν•©λ‹λ‹¤:
1. **μλ™λ§¤λ§¤ κΈ°λ¥**: PyQt5μ λ§¤λ§¤ λ΅μ§μ„ μ›ΉμΌλ΅ ν¬ν…
2. **λ‹¤μ¤‘ μ‚¬μ©μ**: κ³„μ •λ³„ μ›μΉλ¦¬μ¤νΈ λ° ν¬νΈν΄λ¦¬μ¤ κ΄€λ¦¬
3. **λ¨λ°”μΌ μ§€μ›**: λ°μ‘ν• μ›Ή λ””μμΈμ„ ν†µν• λ¨λ°”μΌ μ•± ν™•μ¥
4. **μ‹¤μ‹κ°„ μ°¨νΈ**: TradingView λ“±κ³Ό μ—°λ™ν• κ³ κΈ‰ μ°¨νΈ κΈ°λ¥

**ν”„λ΅μ νΈ μƒνƒ**: π― **ν”„λ΅λ•μ… μ¤€λΉ„ μ™„λ£** (Production Ready)