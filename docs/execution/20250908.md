# ğŸ“ Python íŒŒì¼ êµ¬ì¡°í™” ì‹¤í–‰ ê³„íš

## ğŸ¯ 1ë‹¨ê³„ ëª©í‘œ (í˜„ì¬ Python íŒŒì¼ë§Œ ì²˜ë¦¬)
- ê¸°ì¡´ Python ì½”ë“œë¥¼ ì—­í• ë³„ë¡œ ë¶„ë¦¬
- ì¸í„°í˜ì´ìŠ¤ ê¸°ë°˜ ì„¤ê³„ ì¤€ë¹„
- í–¥í›„ í™•ì¥ì„ ìœ„í•œ ë¹ˆ íŒŒì¼ êµ¬ì¡° ìƒì„±
- ê¸°ì¡´ ê¸°ëŠ¥ ìœ ì§€í•˜ë©´ì„œ ì ì§„ì  ë¦¬íŒ©í† ë§

## ğŸ“‚ ìƒˆë¡œìš´ í´ë” êµ¬ì¡°

```
D:\stocktrading\0908.claude-init\
â”œâ”€â”€ main.py                     # ìƒˆë¡œ ìƒì„±: ì• í”Œë¦¬ì¼€ì´ì…˜ ì§„ì…ì 
â”œâ”€â”€ config.yaml                 # ê¸°ì¡´ ìœ ì§€
â”œâ”€â”€ requirements.txt            # ê¸°ì¡´ ìœ ì§€
â”œâ”€â”€ claude.md                   # ê¸°ì¡´ ìœ ì§€
â”œâ”€â”€ kismain.ui                  # ê¸°ì¡´ ìœ ì§€
â”œâ”€â”€ 
â”œâ”€â”€ core/                       # ìƒˆ í´ë”: í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”‚   â”œâ”€â”€ __init__.py            # ìƒˆë¡œ ìƒì„±
â”‚   â”œâ”€â”€ interfaces/            # ìƒˆ í´ë”: ì¶”ìƒ ì¸í„°í˜ì´ìŠ¤
â”‚   â”‚   â”œâ”€â”€ __init__.py        # ìƒˆë¡œ ìƒì„±
â”‚   â”‚   â”œâ”€â”€ broker_interface.py # ìƒˆë¡œ ìƒì„±: ì¦ê¶Œì‚¬ ì¸í„°í˜ì´ìŠ¤ ì •ì˜
â”‚   â”‚   â””â”€â”€ strategy_interface.py # ìƒˆë¡œ ìƒì„±: ì „ëµ ì¸í„°í˜ì´ìŠ¤ ì •ì˜
â”‚   â”œâ”€â”€ trading_engine.py      # ìƒˆë¡œ ìƒì„±: RSI/MACD ë¡œì§ ì´ë™
â”‚   â””â”€â”€ order_processor.py     # ìƒˆë¡œ ìƒì„±: send_tr_process í•¨ìˆ˜ ì´ë™
â”œâ”€â”€ 
â”œâ”€â”€ brokers/                   # ìƒˆ í´ë”: ì¦ê¶Œì‚¬ë³„ êµ¬í˜„
â”‚   â”œâ”€â”€ __init__.py           # ìƒˆë¡œ ìƒì„±
â”‚   â”œâ”€â”€ korea_investment/     # ìƒˆ í´ë”: í•œêµ­íˆ¬ìì¦ê¶Œ
â”‚   â”‚   â”œâ”€â”€ __init__.py       # ìƒˆë¡œ ìƒì„±
â”‚   â”‚   â”œâ”€â”€ ki_api.py         # ìƒˆë¡œ ìƒì„±: utils.pyì˜ KoreaInvestAPI ì´ë™
â”‚   â”‚   â”œâ”€â”€ ki_env.py         # ìƒˆë¡œ ìƒì„±: utils.pyì˜ KoreaInvestEnv ì´ë™
â”‚   â”‚   â””â”€â”€ token_manager.py  # ìƒˆë¡œ ìƒì„±: utils.pyì˜ TokenManager ì´ë™
â”‚   â”œâ”€â”€ ls_securities/        # ìƒˆ í´ë”: LSì¦ê¶Œ (ë¹ˆ íŒŒì¼ë“¤)
â”‚   â”‚   â”œâ”€â”€ __init__.py       # ìƒˆë¡œ ìƒì„±: ë¹ˆ íŒŒì¼
â”‚   â”‚   â”œâ”€â”€ ls_api.py         # ìƒˆë¡œ ìƒì„±: ë¹ˆ íŒŒì¼, TODO ì£¼ì„ë§Œ
â”‚   â”‚   â””â”€â”€ ls_env.py         # ìƒˆë¡œ ìƒì„±: ë¹ˆ íŒŒì¼, TODO ì£¼ì„ë§Œ
â”‚   â””â”€â”€ factory.py            # ìƒˆë¡œ ìƒì„±: ë¸Œë¡œì»¤ ì„ íƒ ë¡œì§
â”œâ”€â”€ 
â”œâ”€â”€ ui/                       # ìƒˆ í´ë”: UI ì»´í¬ë„ŒíŠ¸
â”‚   â”œâ”€â”€ __init__.py          # ìƒˆë¡œ ìƒì„±
â”‚   â”œâ”€â”€ qt/                  # ìƒˆ í´ë”: PyQt5 ê´€ë ¨
â”‚   â”‚   â”œâ”€â”€ __init__.py      # ìƒˆë¡œ ìƒì„±
â”‚   â”‚   â”œâ”€â”€ main_window.py   # ìƒˆë¡œ ìƒì„±: rsimacd_trading.pyì˜ KISAPIForm ì´ë™
â”‚   â”‚   â””â”€â”€ pandas_model.py  # ìƒˆë¡œ ìƒì„±: rsimacd_trading.pyì˜ PandasModel ì´ë™
â”‚   â”œâ”€â”€ web/                 # ìƒˆ í´ë”: ì›¹ UI (ë¹ˆ íŒŒì¼ë“¤)
â”‚   â”‚   â”œâ”€â”€ __init__.py      # ìƒˆë¡œ ìƒì„±: ë¹ˆ íŒŒì¼
â”‚   â”‚   â””â”€â”€ api_client.py    # ìƒˆë¡œ ìƒì„±: ë¹ˆ íŒŒì¼, TODO ì£¼ì„
â”‚   â””â”€â”€ mobile/              # ìƒˆ í´ë”: ëª¨ë°”ì¼ UI (ë¹ˆ íŒŒì¼ë“¤)
â”‚       â”œâ”€â”€ __init__.py      # ìƒˆë¡œ ìƒì„±: ë¹ˆ íŒŒì¼
â”‚       â””â”€â”€ api_client.py    # ìƒˆë¡œ ìƒì„±: ë¹ˆ íŒŒì¼, TODO ì£¼ì„
â”œâ”€â”€ 
â”œâ”€â”€ services/                # ìƒˆ í´ë”: ì„œë¹„ìŠ¤ ê³„ì¸µ (ë¹ˆ íŒŒì¼ë“¤)
â”‚   â”œâ”€â”€ __init__.py         # ìƒˆë¡œ ìƒì„±
â”‚   â”œâ”€â”€ account_service.py  # ìƒˆë¡œ ìƒì„±: ë¹ˆ íŒŒì¼, TODO ì£¼ì„
â”‚   â”œâ”€â”€ trading_service.py  # ìƒˆë¡œ ìƒì„±: ë¹ˆ íŒŒì¼, TODO ì£¼ì„
â”‚   â””â”€â”€ market_service.py   # ìƒˆë¡œ ìƒì„±: ë¹ˆ íŒŒì¼, TODO ì£¼ì„
â”œâ”€â”€ 
â”œâ”€â”€ utils/                   # ìƒˆ í´ë”: ê³µí†µ ìœ í‹¸ë¦¬í‹°
â”‚   â”œâ”€â”€ __init__.py         # ìƒˆë¡œ ìƒì„±
â”‚   â”œâ”€â”€ logger.py           # ìƒˆë¡œ ìƒì„±: ë¡œê¹… ì„¤ì •
â”‚   â””â”€â”€ helpers.py          # ìƒˆë¡œ ìƒì„±: í—¬í¼ í•¨ìˆ˜ë“¤
â”œâ”€â”€ 
â”œâ”€â”€ data/                   # ìƒˆ í´ë”: ë°ì´í„° íŒŒì¼
â”‚   â””â”€â”€ realtime_watchlist_df.pkl # ê¸°ì¡´ íŒŒì¼ ì´ë™
â”œâ”€â”€ 
â”œâ”€â”€ tests/                  # ìƒˆ í´ë”: í…ŒìŠ¤íŠ¸ (ë¹ˆ íŒŒì¼ë“¤)
â”‚   â”œâ”€â”€ __init__.py        # ìƒˆë¡œ ìƒì„±: ë¹ˆ íŒŒì¼
â”‚   â”œâ”€â”€ test_trading.py    # ìƒˆë¡œ ìƒì„±: ë¹ˆ íŒŒì¼, TODO ì£¼ì„
â”‚   â””â”€â”€ test_brokers.py    # ìƒˆë¡œ ìƒì„±: ë¹ˆ íŒŒì¼, TODO ì£¼ì„
â”œâ”€â”€ 
â””â”€â”€ legacy/                # ìƒˆ í´ë”: ê¸°ì¡´ íŒŒì¼ ë°±ì—…
    â”œâ”€â”€ rsimacd_trading.py # ê¸°ì¡´ íŒŒì¼ ë°±ì—…
    â”œâ”€â”€ utils.py           # ê¸°ì¡´ íŒŒì¼ ë°±ì—…
    â””â”€â”€ kis_stock.py       # ê¸°ì¡´ íŒŒì¼ ë°±ì—…
```

## ğŸ”„ ìƒì„¸ ì‹¤í–‰ ë‹¨ê³„

### Step 1: í´ë” êµ¬ì¡° ìƒì„±
```bash
# ìƒˆ í´ë” ìƒì„±
mkdir core core/interfaces brokers brokers/korea_investment brokers/ls_securities
mkdir ui ui/qt ui/web ui/mobile services utils data tests legacy

# __init__.py íŒŒì¼ ìƒì„±
touch core/__init__.py core/interfaces/__init__.py
touch brokers/__init__.py brokers/korea_investment/__init__.py brokers/ls_securities/__init__.py
touch ui/__init__.py ui/qt/__init__.py ui/web/__init__.py ui/mobile/__init__.py
touch services/__init__.py utils/__init__.py tests/__init__.py
```

### Step 2: ê¸°ì¡´ íŒŒì¼ ë°±ì—…
- `rsimacd_trading.py` â†’ `legacy/rsimacd_trading.py`
- `utils.py` â†’ `legacy/utils.py`
- `kis_stock.py` â†’ `legacy/kis_stock.py`

### Step 3: ì¸í„°í˜ì´ìŠ¤ íŒŒì¼ ìƒì„± (ë¹ˆ íŒŒì¼)

#### `core/interfaces/broker_interface.py`
```python
# TODO: ì¦ê¶Œì‚¬ API ì¶”ìƒ ì¸í„°í˜ì´ìŠ¤ ì •ì˜
# - authenticate()
# - get_account_balance()  
# - place_order()
# - cancel_order()
# - get_stock_price()

from abc import ABC, abstractmethod

class BrokerInterface(ABC):
    pass  # í–¥í›„ êµ¬í˜„ ì˜ˆì •
```

#### `core/interfaces/strategy_interface.py`
```python
# TODO: íŠ¸ë ˆì´ë”© ì „ëµ ì¶”ìƒ ì¸í„°í˜ì´ìŠ¤ ì •ì˜
# - analyze()
# - get_buy_conditions()
# - get_sell_conditions()

from abc import ABC, abstractmethod

class StrategyInterface(ABC):
    pass  # í–¥í›„ êµ¬í˜„ ì˜ˆì •
```

### Step 4: í•µì‹¬ ë¡œì§ íŒŒì¼ ë¶„ë¦¬

#### `core/trading_engine.py`
```python
# rsimacd_trading.pyì—ì„œ ì´ë™í•  ë‚´ìš©:
# - RSI/MACD ê³„ì‚° ë¡œì§ (line 71-82)
# - ë§¤ìˆ˜/ë§¤ë„ ì¡°ê±´ íŒë‹¨ ë¡œì§ (line 383-451)
# - ìˆ˜ìµë¥  ê³„ì‚° ë¡œì§ (line 371-378, 427-434)

import pandas as pd
import talib as ta
from loguru import logger

class TradingEngine:
    def __init__(self):
        pass
    
    def calculate_indicators(self, df):
        # RSI/MACD ê³„ì‚° ë¡œì§ ì´ë™
        pass
    
    def check_buy_signal(self, í˜„MACD, í˜„MACD_signal, ì „MACD, ì „MACD_signal, í˜„RSI, ì „RSI, buy_conditions):
        # ë§¤ìˆ˜ ì‹œê·¸ë„ ì²´í¬ ë¡œì§ ì´ë™
        pass
    
    def check_sell_signal(self, í˜„MACD, í˜„MACD_signal, ì „MACD, ì „MACD_signal, í˜„RSI, ì „RSI, sell_conditions):
        # ë§¤ë„ ì‹œê·¸ë„ ì²´í¬ ë¡œì§ ì´ë™  
        pass
```

#### `core/order_processor.py`
```python
# rsimacd_trading.pyì—ì„œ ì´ë™í•  ë‚´ìš©:
# - send_tr_process() í•¨ìˆ˜ ì „ì²´ (line 25-111)

from multiprocessing import Queue
from loguru import logger

def send_tr_process(korea_invest_api, tr_req_queue: Queue, tr_result_queue: Queue):
    # ê¸°ì¡´ send_tr_process í•¨ìˆ˜ ë‚´ìš© ì´ë™
    pass
```

### Step 5: API í´ë˜ìŠ¤ ë¶„ë¦¬

#### `brokers/korea_investment/ki_api.py`
```python
# utils.pyì—ì„œ ì´ë™í•  ë‚´ìš©:
# - KoreaInvestAPI í´ë˜ìŠ¤ ì „ì²´ (line 421-1024)

class KoreaInvestAPI:
    # utils.pyì˜ KoreaInvestAPI í´ë˜ìŠ¤ ë‚´ìš© ì´ë™
    pass
```

#### `brokers/korea_investment/ki_env.py`
```python
# utils.pyì—ì„œ ì´ë™í•  ë‚´ìš©:
# - KoreaInvestEnv í´ë˜ìŠ¤ (line 128-420)

class KoreaInvestEnv:
    # utils.pyì˜ KoreaInvestEnv í´ë˜ìŠ¤ ë‚´ìš© ì´ë™
    pass
```

#### `brokers/korea_investment/token_manager.py`
```python
# utils.pyì—ì„œ ì´ë™í•  ë‚´ìš©:
# - TokenManager í´ë˜ìŠ¤ (line 32-127)

class TokenManager:
    # utils.pyì˜ TokenManager í´ë˜ìŠ¤ ë‚´ìš© ì´ë™
    pass
```

### Step 6: UI í´ë˜ìŠ¤ ë¶„ë¦¬

#### `ui/qt/main_window.py`
```python
# rsimacd_trading.pyì—ì„œ ì´ë™í•  ë‚´ìš©:
# - KISAPIForm í´ë˜ìŠ¤ ì „ì²´ (line 198-569)

from PyQt5.QtWidgets import QMainWindow
from PyQt5 import uic

form_class = uic.loadUiType("kismain.ui")[0]

class KISAPIForm(QMainWindow, form_class):
    # ê¸°ì¡´ KISAPIForm í´ë˜ìŠ¤ ë‚´ìš© ì´ë™
    pass
```

#### `ui/qt/pandas_model.py`
```python
# rsimacd_trading.pyì—ì„œ ì´ë™í•  ë‚´ìš©:
# - PandasModel í´ë˜ìŠ¤ (line 116-187)

from PyQt5.QtCore import QAbstractTableModel

class PandasModel(QAbstractTableModel):
    # ê¸°ì¡´ PandasModel í´ë˜ìŠ¤ ë‚´ìš© ì´ë™
    pass
```

### Step 7: ìƒˆë¡œìš´ main.py ìƒì„±
```python
# ì• í”Œë¦¬ì¼€ì´ì…˜ ì§„ì…ì 
# rsimacd_trading.pyì˜ main ì‹¤í–‰ ë¶€ë¶„ (line 573-609) ì´ë™ ë° ìˆ˜ì •

import sys
from PyQt5.QtWidgets import QApplication
from ui.qt.main_window import KISAPIForm
from brokers.korea_investment.ki_api import KoreaInvestAPI
from brokers.korea_investment.ki_env import KoreaInvestEnv

if __name__ == '__main__':
    # ê¸°ì¡´ main ì‹¤í–‰ ë¡œì§ì„ ìƒˆ êµ¬ì¡°ì— ë§ê²Œ ìˆ˜ì •
    pass
```

### Step 8: ë¹ˆ íŒŒì¼ë“¤ ìƒì„± (í–¥í›„ í™•ì¥ìš©)

#### `brokers/ls_securities/ls_api.py`
```python
# TODO: LSì¦ê¶Œ API êµ¬í˜„ ì˜ˆì •
# BrokerInterfaceë¥¼ ìƒì†ë°›ì•„ êµ¬í˜„

from core.interfaces.broker_interface import BrokerInterface

class LSSecuritiesAPI(BrokerInterface):
    pass  # í–¥í›„ êµ¬í˜„ ì˜ˆì •
```

#### `services/account_service.py`
```python
# TODO: ê³„ì¢Œ ê´€ë ¨ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì„œë¹„ìŠ¤
# - ê³„ì¢Œ ì¡°íšŒ ë¡œì§
# - ì”ê³  ê´€ë¦¬
# - ìˆ˜ìµë¥  ê³„ì‚°

class AccountService:
    pass  # í–¥í›„ êµ¬í˜„ ì˜ˆì •
```

#### `ui/web/api_client.py`
```python
# TODO: ì›¹ í´ë¼ì´ì–¸íŠ¸ìš© API í˜¸ì¶œ í´ë˜ìŠ¤
# Next.jsì—ì„œ ì‚¬ìš©í•  API í´ë¼ì´ì–¸íŠ¸

class WebAPIClient:
    pass  # í–¥í›„ êµ¬í˜„ ì˜ˆì •
```

### Step 9: ìœ í‹¸ë¦¬í‹° íŒŒì¼ ìƒì„±

#### `utils/logger.py`
```python
# ë¡œê¹… ì„¤ì • í†µí•© ê´€ë¦¬
from loguru import logger
import sys

def setup_logger():
    logger.remove()
    logger.add(sys.stdout, level="INFO")
    logger.add("data/logs/app.log", rotation="1 day", level="DEBUG")
```

#### `utils/helpers.py`
```python
# ê³µí†µ í—¬í¼ í•¨ìˆ˜ë“¤
def format_currency(amount):
    return f"{amount:,}ì›"

def calculate_profit_rate(current_price, avg_price):
    if avg_price and avg_price != 0:
        return round((current_price - avg_price) / avg_price * 100, 2)
    return 0.0
```

### Step 10: Import ìˆ˜ì • ë° í…ŒìŠ¤íŠ¸
- ê° íŒŒì¼ì˜ import êµ¬ë¬¸ ìˆ˜ì •
- ê¸°ë³¸ ê¸°ëŠ¥ ë™ì‘ í…ŒìŠ¤íŠ¸
- ì˜¤ë¥˜ ìˆ˜ì • ë° ë””ë²„ê¹…

## ğŸ¯ ì™„ë£Œ í›„ ìƒíƒœ

### ë™ì‘í•˜ëŠ” íŒŒì¼ë“¤
- `main.py`: ê¸°ì¡´ê³¼ ë™ì¼í•œ PyQt5 ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰
- `core/`: RSI/MACD íŠ¸ë ˆì´ë”© ë¡œì§ í¬í•¨
- `brokers/korea_investment/`: í•œêµ­íˆ¬ìì¦ê¶Œ API ì™„ì „ ë™ì‘
- `ui/qt/`: PyQt5 UI ì™„ì „ ë™ì‘

### ì¤€ë¹„ëœ ë¹ˆ íŒŒì¼ë“¤  
- `brokers/ls_securities/`: LSì¦ê¶Œ ì—°ë™ ì¤€ë¹„
- `ui/web/`, `ui/mobile/`: ì›¹/ëª¨ë°”ì¼ í´ë¼ì´ì–¸íŠ¸ ì¤€ë¹„
- `services/`: ì„œë¹„ìŠ¤ ê³„ì¸µ ì¤€ë¹„
- `tests/`: í…ŒìŠ¤íŠ¸ ì½”ë“œ ì¤€ë¹„

## âœ… ì„±ê³µ ê¸°ì¤€
1. ê¸°ì¡´ PyQt5 ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ìƒˆ êµ¬ì¡°ì—ì„œ ì •ìƒ ë™ì‘
2. ëª¨ë“  íŠ¸ë ˆì´ë”© ê¸°ëŠ¥ (ë§¤ìˆ˜/ë§¤ë„/ê³„ì¢Œì¡°íšŒ) ì •ìƒ ì‘ë™
3. ì½”ë“œê°€ ì—­í• ë³„ë¡œ ëª…í™•íˆ ë¶„ë¦¬ë¨
4. í–¥í›„ í™•ì¥ì„ ìœ„í•œ ì¸í„°í˜ì´ìŠ¤ì™€ ë¹ˆ íŒŒì¼ êµ¬ì¡° ì™„ì„±

## ğŸ“… ì‘ì„±ì¼
2025-09-08

## ğŸ”„ ì‹¤í–‰ ìƒíƒœ
- [ ] Step 1: í´ë” êµ¬ì¡° ìƒì„±
- [ ] Step 2: ê¸°ì¡´ íŒŒì¼ ë°±ì—…
- [ ] Step 3: ì¸í„°í˜ì´ìŠ¤ íŒŒì¼ ìƒì„±
- [ ] Step 4: í•µì‹¬ ë¡œì§ íŒŒì¼ ë¶„ë¦¬
- [ ] Step 5: API í´ë˜ìŠ¤ ë¶„ë¦¬
- [ ] Step 6: UI í´ë˜ìŠ¤ ë¶„ë¦¬
- [ ] Step 7: ìƒˆë¡œìš´ main.py ìƒì„±
- [ ] Step 8: ë¹ˆ íŒŒì¼ë“¤ ìƒì„±
- [ ] Step 9: ìœ í‹¸ë¦¬í‹° íŒŒì¼ ìƒì„±
- [ ] Step 10: Import ìˆ˜ì • ë° í…ŒìŠ¤íŠ¸