<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Smart Trading Mobile</title>
    <link rel="stylesheet" href="css/robinhood.css">
    <link rel="stylesheet" href="css/mobile.css">
    <meta name="description" content="ëª¨ë°”ì¼ ìµœì í™”ëœ ìŠ¤ë§ˆíŠ¸ íŠ¸ë ˆì´ë”© ì•±">
    <meta name="theme-color" content="#110E08">

    <!-- PWA ë§¤ë‹ˆí˜ìŠ¤íŠ¸ -->
    <link rel="manifest" href="manifest.json">

    <!-- í„°ì¹˜ ì•„ì´ì½˜ -->
    <link rel="apple-touch-icon" href="assets/icon-192.png">

    <!-- ìƒíƒœë°” ìŠ¤íƒ€ì¼ -->
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-capable" content="yes">
</head>
<body class="mobile-body">
    <!-- ëª¨ë°”ì¼ í—¤ë” -->
    <header class="mobile-header">
        <div class="mobile-header__content">
            <div class="mobile-header__logo">
                <span class="mobile-header__icon">ğŸ›ï¸</span>
                <span class="mobile-header__title">Smart Trading</span>
            </div>
            <div class="mobile-header__actions">
                <button class="mobile-header__btn">ğŸ””</button>
                <button class="mobile-header__btn">ğŸ‘¤</button>
            </div>
        </div>
    </header>

    <!-- ëª¨ë°”ì¼ ë©”ì¸ ì½˜í…ì¸  -->
    <main class="mobile-main">
        <!-- í¬íŠ¸í´ë¦¬ì˜¤ ì¹´ë“œ -->
        <section class="mobile-portfolio-card">
            <div id="mobile-portfolio-summary" class="mobile-portfolio-summary">
                <!-- JavaScriptë¡œ ë™ì  ìƒì„± -->
            </div>
            <div class="mobile-portfolio-actions">
                <button class="mobile-action-btn mobile-action-btn--buy">
                    <span class="mobile-action-btn__icon">ğŸ’°</span>
                    <span class="mobile-action-btn__text">ë§¤ìˆ˜</span>
                </button>
                <button class="mobile-action-btn mobile-action-btn--sell">
                    <span class="mobile-action-btn__icon">ğŸ’¸</span>
                    <span class="mobile-action-btn__text">ë§¤ë„</span>
                </button>
            </div>
        </section>

        <!-- ë¹ ë¥¸ í†µê³„ -->
        <section class="mobile-quick-stats">
            <div class="mobile-stat-card">
                <div class="mobile-stat-card__label">ì¼ì¼ ìˆ˜ìµ</div>
                <div class="mobile-stat-card__value mobile-stat-card__value--positive">+125,000ì›</div>
            </div>
            <div class="mobile-stat-card">
                <div class="mobile-stat-card__label">ì´ ìˆ˜ìµë¥ </div>
                <div class="mobile-stat-card__value mobile-stat-card__value--positive">+6.66%</div>
            </div>
            <div class="mobile-stat-card">
                <div class="mobile-stat-card__label">ë³´ìœ  ì¢…ëª©</div>
                <div class="mobile-stat-card__value">3ê°œ</div>
            </div>
        </section>

        <!-- ëª¨ë°”ì¼ ì£¼ì‹ ë¦¬ìŠ¤íŠ¸ -->
        <section class="mobile-stocks-section">
            <div class="mobile-section-header">
                <h2 class="mobile-section-title">ë‚´ ì¢…ëª©</h2>
                <button class="mobile-view-all-btn">ì „ì²´ë³´ê¸°</button>
            </div>
            <div id="mobile-stock-list" class="mobile-stock-list">
                <!-- JavaScriptë¡œ ë™ì  ìƒì„± -->
            </div>
        </section>

        <!-- ê´€ì‹¬ì¢…ëª© ì„¹ì…˜ -->
        <section class="mobile-stocks-section">
            <div class="mobile-section-header">
                <h2 class="mobile-section-title">ê´€ì‹¬ì¢…ëª©</h2>
                <button class="mobile-view-all-btn">í¸ì§‘</button>
            </div>
            <div class="mobile-watchlist">
                <!-- ê´€ì‹¬ì¢…ëª© ëª©ë¡ -->
            </div>
        </section>
    </main>

    <!-- ëª¨ë°”ì¼ í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ -->
    <nav class="mobile-bottom-nav">
        <button class="mobile-nav-item mobile-nav-item--active">
            <div class="mobile-nav-item__icon">ğŸ </div>
            <div class="mobile-nav-item__label">í™ˆ</div>
        </button>
        <button class="mobile-nav-item">
            <div class="mobile-nav-item__icon">ğŸ’¼</div>
            <div class="mobile-nav-item__label">í¬íŠ¸í´ë¦¬ì˜¤</div>
        </button>
        <button class="mobile-nav-item">
            <div class="mobile-nav-item__icon">ğŸ“ˆ</div>
            <div class="mobile-nav-item__label">ê±°ë˜</div>
        </button>
        <button class="mobile-nav-item">
            <div class="mobile-nav-item__icon">ğŸ”</div>
            <div class="mobile-nav-item__label">ê²€ìƒ‰</div>
        </button>
        <button class="mobile-nav-item">
            <div class="mobile-nav-item__icon">âš™ï¸</div>
            <div class="mobile-nav-item__label">ì„¤ì •</div>
        </button>
    </nav>

    <!-- í’€ íˆ¬ ë¦¬í”„ë ˆì‹œ -->
    <div class="pull-to-refresh" id="pullToRefresh">
        <div class="pull-to-refresh__spinner">
            <div class="loading"></div>
        </div>
        <div class="pull-to-refresh__text">ë‹¹ê²¨ì„œ ìƒˆë¡œê³ ì¹¨</div>
    </div>

    <!-- JavaScript íŒŒì¼ë“¤ -->
    <script src="js/sample-data.js"></script>
    <script src="js/chart.js"></script>
    <script src="js/main.js"></script>

    <!-- ëª¨ë°”ì¼ ì „ìš© JavaScript -->
    <script>
        class MobileApp {
            constructor() {
                this.setupMobileFeatures();
                this.setupPullToRefresh();
                this.setupSwipeGestures();
            }

            setupMobileFeatures() {
                // í¬íŠ¸í´ë¦¬ì˜¤ ìš”ì•½ ë Œë”ë§ (ëª¨ë°”ì¼ ìµœì í™”)
                this.renderMobilePortfolioSummary();
                this.renderMobileStockList();

                // í„°ì¹˜ ì´ë²¤íŠ¸ ìµœì í™”
                this.optimizeTouchEvents();
            }

            renderMobilePortfolioSummary() {
                const portfolioData = window.sampleData.getPortfolioData();
                const summaryElement = document.getElementById('mobile-portfolio-summary');

                if (!summaryElement) return;

                const isPositive = portfolioData.totalGain >= 0;
                const gainClass = isPositive ? 'mobile-portfolio-gain--positive' : 'mobile-portfolio-gain--negative';

                summaryElement.innerHTML = `
                    <div class="mobile-portfolio-value">
                        ${this.formatCurrency(portfolioData.totalValue)}
                    </div>
                    <div class="mobile-portfolio-gain ${gainClass}">
                        ${isPositive ? 'â–²' : 'â–¼'} ${this.formatCurrency(Math.abs(portfolioData.totalGain))} (${Math.abs(portfolioData.totalGainPercent).toFixed(2)}%)
                    </div>
                `;
            }

            renderMobileStockList() {
                const positions = window.sampleData.getPositions();
                const listElement = document.getElementById('mobile-stock-list');

                if (!listElement) return;

                listElement.innerHTML = positions.map(position => {
                    const isPositive = position.gain >= 0;
                    const gainClass = isPositive ? 'mobile-stock-gain--positive' : 'mobile-stock-gain--negative';

                    return `
                        <div class="mobile-stock-item" data-symbol="${position.code}">
                            <div class="mobile-stock-info">
                                <div class="mobile-stock-symbol">${position.code}</div>
                                <div class="mobile-stock-name">${position.name}</div>
                                <div class="mobile-stock-shares">${position.shares}ì£¼</div>
                            </div>
                            <div class="mobile-stock-price">
                                <div class="mobile-stock-current">${this.formatPrice(position.currentPrice)}</div>
                                <div class="mobile-stock-gain ${gainClass}">
                                    ${this.formatCurrency(position.gain)} (${position.gainPercent.toFixed(2)}%)
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
            }

            setupPullToRefresh() {
                let startY = 0;
                let currentY = 0;
                let isRefreshing = false;

                const pullToRefresh = document.getElementById('pullToRefresh');

                document.addEventListener('touchstart', (e) => {
                    if (window.scrollY === 0) {
                        startY = e.touches[0].pageY;
                    }
                });

                document.addEventListener('touchmove', (e) => {
                    if (window.scrollY === 0 && !isRefreshing) {
                        currentY = e.touches[0].pageY;
                        const pullDistance = currentY - startY;

                        if (pullDistance > 0) {
                            e.preventDefault();
                            const opacity = Math.min(pullDistance / 100, 1);
                            pullToRefresh.style.opacity = opacity;
                            pullToRefresh.style.transform = `translateY(${Math.min(pullDistance - 50, 50)}px)`;
                        }
                    }
                });

                document.addEventListener('touchend', () => {
                    if (currentY - startY > 100 && !isRefreshing) {
                        this.performRefresh();
                    } else {
                        pullToRefresh.style.opacity = '0';
                        pullToRefresh.style.transform = 'translateY(-50px)';
                    }
                });
            }

            setupSwipeGestures() {
                let startX = 0;
                let startY = 0;

                document.addEventListener('touchstart', (e) => {
                    startX = e.touches[0].pageX;
                    startY = e.touches[0].pageY;
                });

                document.addEventListener('touchend', (e) => {
                    const endX = e.changedTouches[0].pageX;
                    const endY = e.changedTouches[0].pageY;
                    const deltaX = endX - startX;
                    const deltaY = endY - startY;

                    // ê°€ë¡œ ìŠ¤ì™€ì´í”„ ê°ì§€ (ì„¸ë¡œ ìŠ¤ì™€ì´í”„ë³´ë‹¤ ê°€ë¡œê°€ ë” í´ ë•Œ)
                    if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > 50) {
                        if (deltaX > 0) {
                            // ì˜¤ë¥¸ìª½ ìŠ¤ì™€ì´í”„
                            this.handleRightSwipe();
                        } else {
                            // ì™¼ìª½ ìŠ¤ì™€ì´í”„
                            this.handleLeftSwipe();
                        }
                    }
                });
            }

            performRefresh() {
                const pullToRefresh = document.getElementById('pullToRefresh');
                pullToRefresh.style.opacity = '1';
                pullToRefresh.style.transform = 'translateY(0px)';

                // ì‹¤ì œ ë°ì´í„° ìƒˆë¡œê³ ì¹¨ ì‹œë®¬ë ˆì´ì…˜
                setTimeout(() => {
                    this.renderMobilePortfolioSummary();
                    this.renderMobileStockList();

                    pullToRefresh.style.opacity = '0';
                    pullToRefresh.style.transform = 'translateY(-50px)';

                    // í”¼ë“œë°± ì§„ë™
                    if (navigator.vibrate) {
                        navigator.vibrate(50);
                    }
                }, 1000);
            }

            handleRightSwipe() {
                console.log('Right swipe detected');
            }

            handleLeftSwipe() {
                console.log('Left swipe detected');
            }

            optimizeTouchEvents() {
                // í„°ì¹˜ ì´ë²¤íŠ¸ ìµœì í™”
                document.addEventListener('touchstart', (e) => {
                    // í„°ì¹˜ ì‹œì‘ ì‹œ í”¼ë“œë°±
                    const target = e.target.closest('.mobile-action-btn, .mobile-stock-item, .mobile-nav-item');
                    if (target) {
                        target.style.transform = 'scale(0.95)';
                        target.style.opacity = '0.8';
                    }
                });

                document.addEventListener('touchend', (e) => {
                    // í„°ì¹˜ ì¢…ë£Œ ì‹œ ì›ìƒë³µêµ¬
                    const target = e.target.closest('.mobile-action-btn, .mobile-stock-item, .mobile-nav-item');
                    if (target) {
                        setTimeout(() => {
                            target.style.transform = 'scale(1)';
                            target.style.opacity = '1';
                        }, 100);
                    }
                });
            }

            formatCurrency(amount) {
                if (amount >= 100000000) {
                    return `${(amount / 100000000).toFixed(1)}ì–µì›`;
                } else if (amount >= 10000) {
                    return `${(amount / 10000).toFixed(0)}ë§Œì›`;
                } else {
                    return `${amount.toLocaleString()}ì›`;
                }
            }

            formatPrice(price) {
                return price.toLocaleString() + 'ì›';
            }
        }

        // ëª¨ë°”ì¼ ì•± ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', () => {
            window.mobileApp = new MobileApp();
        });

        // í™”ë©´ íšŒì „ ì²˜ë¦¬
        window.addEventListener('orientationchange', () => {
            setTimeout(() => {
                window.location.reload();
            }, 500);
        });
    </script>
</body>
</html>